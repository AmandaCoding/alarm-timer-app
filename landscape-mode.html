<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Landscape Mode - Stopwatch & Weather</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(to right, #a0c4ff, #87b0ff);
      color: white;
      display: flex;
      flex-direction: row; /* Keep as row for landscape */
      justify-content: center; /* Center horizontally */
      align-items: center; /* Center vertically */
      min-height: 100vh;
      width: 100vw;
      text-align: center;
      margin: 0;
      padding: 1rem; /* Add some padding to the body */
      box-sizing: border-box;
      gap: 1.5rem; /* Space between the two main section groups */
      overflow-y: auto; /* Allow vertical scrolling if content is too tall */
      overflow-x: hidden; /* Prevent horizontal scrolling */
    }

    .section-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1; /* Allows groups to grow and shrink */
      max-width: 450px; /* Limit maximum width for larger screens */
      min-width: 300px; /* Ensure a minimum width for readability */
      /* No explicit width, let flex handle it within max/min constraints */
    }

    .section-card {
      background-color: rgba(255, 255, 255, 0.7);
      border-radius: 20px;
      padding: 1.2rem;
      width: 100%; /* Take full width of its parent .section-group */
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 220px;
      transition: all 0.3s ease-in-out;
      position: relative;
      overflow: hidden;
      border: 2px solid rgba(255, 255, 255, 0.8);
      margin-top: 1rem;
    }

    .section-card::before {
      content: '';
      position: absolute; inset: 0;
      background-image:
        linear-gradient(45deg, hsla(210, 70%, 85%, 0.6) 25%, transparent 25%, transparent 75%, hsla(210, 70%, 85%, 0.6) 75%, hsla(210, 70%, 85%, 0.6) 100%),
        linear-gradient(-45deg, hsla(210, 70%, 85%, 0.6) 25%, transparent 25%, transparent 75%, hsla(210, 70%, 85%, 0.6) 75%, hsla(210, 70%, 85%, 0.6) 100%);
      background-size: 25px 25px;
      background-position: 0 0, 12.5px 12.5px;
      pointer-events: none;
    }
    .section-card > * { position: relative; z-index: 10; }

    .section-title-ribbon {
      background-color: #72a0e2;
      color: white;
      font-weight: 800;
      padding: 0.5rem 1.2rem;
      border-radius: 8px;
      position: relative;
      font-size: 1.2rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .stopwatch-display {
      font-size: 4rem; /* Changed from vw to rem for better control */
      font-weight: 800;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      margin-bottom: 1rem;
      white-space: nowrap;
      color: white;
    }

    .action-button {
      background-color: #72a0e2;
      color: white;
      padding: 0.6rem 1.2rem;
      border-radius: 10px;
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
      border: none;
      margin: 0.3rem;
      transition: background-color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .action-button:hover { background-color: #5a85cc; transform: translateY(-2px); }
    .action-button:active { background-color: #4a74b8; transform: translateY(1px); }

    .weather-info { display: flex; flex-direction: column; align-items: center; gap: 0.4rem; }
    .weather-icon { width: 70px; height: 70px; }
    .weather-temp { font-size: 3.5rem; /* Changed from vw to rem for better control */
      font-weight: 700; }
    .weather-desc, .weather-city { font-size: 1rem; font-weight: 500; }

    .loading-spinner {
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      width: 28px; height: 28px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { 0%{transform:rotate(0);} 100%{transform:rotate(360deg);} }

    /* Mobile friendly */
    @media (max-width: 768px) {
      body { flex-direction: column; align-items: center; }
      .section-group { max-width: 90%; min-width: unset; /* Allow it to shrink on small screens */ }
      .stopwatch-display { font-size: 10vw; } /* Revert to vw for very small screens */
      .weather-temp { font-size: 8vw; } /* Revert to vw for very small screens */
    }
  </style>
</head>
<body>
  <div class="section-group">
    <div class="section-title-ribbon">STOPWATCH</div>
    <div class="section-card">
      <div id="stopwatch-display" class="stopwatch-display">00:00:00</div>
      <div class="flex mt-3 flex-wrap justify-center">
        <button id="stopwatch-start" class="action-button">START</button>
        <button id="stopwatch-pause" class="action-button">PAUSE</button>
        <button id="stopwatch-reset" class="action-button">RESET</button>
      </div>
    </div>
  </div>

  <div class="section-group">
    <div class="section-title-ribbon">WEATHER</div>
    <div class="section-card">
      <div style="margin-bottom: 1rem; width:100%; text-align:center;">
        <input type="text" id="city-input" placeholder="Enter city..."
          style="padding:0.5rem; border-radius:8px; border:none; width:65%; color:black; margin-right:0.5rem;">
        <button id="search-btn"
          style="padding:0.5rem 1rem; border:none; border-radius:8px; background:#003049; color:white; cursor:pointer;">
          Search
        </button>
      </div>
      <div id="weather-content">
        <div class="loading-spinner"></div>
        <p class="mt-2">Loading weather...</p>
      </div>
    </div>
  </div>

<script>
  // Orientation -> go back to portrait
  function handleOrientationChange() {
    const isPortrait = window.innerHeight > window.innerWidth;
    const currentPath = window.location.pathname;
    // Check if currently in landscape-mode.html and if the orientation is now portrait
    if (isPortrait && currentPath.includes("landscape-mode.html")) {
      window.location.href = "index.html"; // Redirect to index.html
    }
  }
  window.addEventListener("orientationchange", handleOrientationChange);
  window.addEventListener("resize", handleOrientationChange);
  document.addEventListener("DOMContentLoaded", handleOrientationChange); // Initial check

  // Weather API
  const apiKey = "b67863341cf6b3f6eb9dde5fe5298809"; // Using a placeholder for the actual API key. You should replace this with a valid key.

  async function fetchWeather(city) {
    try {
      const res = await fetch(
        `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${apiKey}`
      );
      const data = await res.json();
      if (data.cod !== 200) {
        document.getElementById("weather-content").innerHTML = "<p>⚠️ City not found.</p>";
        return;
      }
      document.getElementById("weather-content").innerHTML = `
        <div class="weather-info">
          <img src="https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png" class="weather-icon">
          <div class="weather-temp">${Math.round(data.main.temp)}°C</div>
          <div class="weather-desc">${data.weather[0].description}</div>
          <div class="weather-city">${data.name}</div>
        </div>`;
    } catch {
      document.getElementById("weather-content").innerHTML = "<p>⚠️ Unable to load weather.</p>";
    }
  }

  function fetchWeatherByCoords(lat, lon) {
    fetch(
      `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`
    )
    .then(res => res.json())
    .then(data => {
      document.getElementById("weather-content").innerHTML = `
        <div class="weather-info">
          <img src="https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png" class="weather-icon">
          <div class="weather-temp">${Math.round(data.main.temp)}°C</div>
          <div class="weather-desc">${data.weather[0].description}</div>
          <div class="weather-city">${data.name}</div>
        </div>`;
    })
    .catch(()=>{ fetchWeather("New Delhi"); });
  }

  document.addEventListener("DOMContentLoaded", () => {
    // Check for geolocation support
    if (navigator.geolocation) {
      // Get current position
      navigator.geolocation.getCurrentPosition(
        // Success callback
        pos => fetchWeatherByCoords(pos.coords.latitude, pos.coords.longitude),
        // Error callback, fallback to default city
        () => fetchWeather("New Delhi")
      );
    } else {
      // Geolocation not supported, fallback to default city
      fetchWeather("New Delhi");
    }
    // Event listener for search button
    document.getElementById("search-btn").addEventListener("click", () => {
      const city = document.getElementById("city-input").value;
      if (city) fetchWeather(city); // Fetch weather if city input is not empty
    });
  });

  // Stopwatch logic
  let stopwatchInterval;
  let elapsedTime = 0;
  let isRunning = false;

  const stopwatchDisplay = document.getElementById("stopwatch-display");
  const startBtn = document.getElementById("stopwatch-start");
  const pauseBtn = document.getElementById("stopwatch-pause");
  const resetBtn = document.getElementById("stopwatch-reset");

  function updateDisplay() {
    let hours = Math.floor(elapsedTime / 3600);
    let minutes = Math.floor((elapsedTime % 3600) / 60);
    let seconds = elapsedTime % 60;

    stopwatchDisplay.textContent = 
      String(hours).padStart(2, "0") + ":" +
      String(minutes).padStart(2, "0") + ":" +
      String(seconds).padStart(2, "0");
  }

  startBtn.addEventListener("click", () => {
    if (!isRunning) {
      isRunning = true;
      stopwatchInterval = setInterval(() => {
        elapsedTime++;
        updateDisplay();
      }, 1000);
    }
  });

  pauseBtn.addEventListener("click", () => {
    clearInterval(stopwatchInterval);
    isRunning = false;
  });

  resetBtn.addEventListener("click", () => {
    clearInterval(stopwatchInterval);
    isRunning = false;
    elapsedTime = 0;
    updateDisplay();
  });

  // Initialize display
  updateDisplay();
</script>
</body>
</html>
